[%- IF onlineparse == 1 -%]
	[%- SET UpdatedName = "Parsed at" -%]
	[%- SET DisplayProp = "none" -%]
[%- ELSE -%]
	[%- SET UpdatedName = "Updated at" -%]
	[%- SET DisplayProp = "inline" -%]
[%- END -%]
[% FOREACH B = bouncemessages %]
	[%- IF isupdated == 1 -%]
		[%- SET displayproperty = 'block' -%]
	[%- ELSE -%]
		[%- SET displayproperty = 'none' -%]
		[%- IF isremoved == 1 -%]
			[%- SET removedclassname = 'isremoved' -%]
		[%- END -%]
	[%- END -%]
	<div id = 'record-of-[% B.id %]' class = 'record'>
		<div class = 'recordsummary [%- removedclassname -%]' id = 'summary-of-[% B.id %]'>
			<div class = 'number-in-summary'>
				<div class = 'id'># [% B.id %]</div>
				[%- IF isremoved == 1 -%]
					<div class = 'reason void'>[% B.reason %]</div>
				[%- ELSE -%]
					<div class = 'reason [% B.reason %]'>[% B.reason %]</div>
				[%- END -%]
			</div>
			<div class = 'status-in-summary'>
				[%- IF isremoved == 1 -%]
					<div class = 'frequency' style = 'color: #fffffc; font-size: 10px; font-weight: bold;'>Removed</div>
				[%- ELSE -%]
					<div class = 'frequency'>[% B.frequency %]</div>
					<span class = 'flatbutton'>
					<a href = "javascript:void(0)" 
						onClick = "toggleIt('details-of-[% B.id %]');">Details</a>
					</span>
				[%- END -%]
			</div>
			<div class = 'fields-in-summary'>
				<table><tbody>
					<tr>
						<td class = 'key-in-summary'>From:</td>
						<td class = 'value-in-summary'>[% B.addresser %]</td>
					</tr>
					<tr>
						<td class = 'key-in-summary'>To:</td>
						<td class = 'value-in-summary'>[% B.recipient %]</td>
					</tr>
					<tr>
						<td class = 'key-in-summary'>Date:</td>
						<td class = 'value-in-summary'>[% B.bounced %]</td>
					</tr>
				</tbody></table>
			</div>

			<div class = 'recorddetails' id = 'details-of-[% B.id %]' style = 'display: [% displayproperty %];'>
				<h4>Record Details</h4>
				[%- prototype.form_remote_tag( {
						url => "${scriptname}/update/${B.id}",
						update => "record-of-${B.id}",
						loading => "disableIt('do-update-${B.id}');",
					});
				-%]
				<table>
				<tbody>
					<tr>
						<td class = 'key'>Record ID</td>
						<td class = 'value'>[% B.id %]</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'id' value = '[% B.id %]' />
							<input type = 'hidden' name = 'language' value = '[% mylanguage %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>Sender Address(From:)</td>
						<td class = 'value'>[% B.addresser %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Recipient Address(To:)</td>
						<td class = 'value'> [% B.recipient %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Frequency</td>
						<td class = 'value'>[% B.frequency %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Reason</td>
						<td class = 'value'>[% INCLUDE "select-reason.${mylanguage}.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Host Group</td>
						<td class = 'value'>[% INCLUDE "select-hostgroup.${mylanguage}.html" %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Provider</td>
						<td class = 'value'> [% B.provider %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Description</td>
						<td class = 'value' style = "font-style: italic;">[% B.diagnosticcode %]</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>Message Token(MD5)</td>
						<td class = 'value'>
							<span class = 'token'>
								<input type = 'text' value = '[% B.token %]' />
							</span>
						</td>
						<td class = 'extra'>
							<input type = 'hidden' name = 'token' value = '[% B.token %]' />
						</td>
					</tr>

					<tr>
						<td class = 'key'>Bounced at</td>
						<td class = 'value'>
							[% B.bounced %]
							[%- IF tzoffset != B.tzoffset -%] [% tzoffset %] &lt;- ([% B.tzoffset %])[%- END -%]
						</td>
						<td class = 'extra'></td>
					</tr>

					<tr>
						<td class = 'key'>[% UpdatedName %]</td>
						<td class = 'value'>
							[%- IF isupdated == 1 -%]<strong>[%- END -%]
							[% B.updated %]
							[%- IF isupdated == 1 -%]</strong>[%- END -%]
						</td>
						<td class = 'extra'>
							<input type = 'submit' id = 'do-update-[% B.id %]' style = 'display: [% DisplayProp %];'
								class = 'flatbutton' value = 'Update' disabled onClick = "this.value = 'Updating...';" />
						</td>
					</tr>
				</tbody>
				</table>
				</form>

				[%- prototype.form_remote_tag( {
						url => "${scriptname}/delete/${B.id}",
						update => "record-of-${B.id}",
						loading => "disableIt('do-delete-${B.id}');",
					});
				-%]
				<input type = 'hidden' name = 'token' value = '[% B.token %]' />
				<input type = 'submit' id = 'do-delete-[% B.id %]' style = 'display: [% DisplayProp %];'
					class = 'flatbutton caution' value = ' Delete ' disabled onClick = "this.value = 'Deleting...';" />
				<input type = 'checkbox' name = 'enabledelete' 
					onChange = "
						if( this.checked == true ){
							enableIt('do-delete-[% B.id %]');
							disableIt('do-update-[% B.id %]');
							disableIt('reasons-of-[% B.id %]');
							disableIt('hostgroups-of-[% B.id %]');
						}
						else{
							disableIt('do-delete-[% B.id %]');
							enableIt('reasons-of-[% B.id %]');
							enableIt('hostgroups-of-[% B.id %]');
						}"/> &larr; Check here to delete this record.
				</form>
			</div>
		</div>
	</div>
[% END %]
